import{j as l,s as N,x as D,T as k,o as s,f as n,a as C,u as E,b as h,g as b,F as L,Z as O,y as T,z as B}from"./app-BqzU3v1C.js";import"./toast-s2dejMsm.js";import{u as P}from"./vue-timer-hook.esm-bundler-CX5zjuCJ.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";const J=o=>(T("data-v-8df1b777"),o=o(),B(),o),V={class:"grid grid-cols-1"},F=J(()=>h("canvas",{id:"pdf-canvas"},null,-1)),q={key:0},z={key:1},M={__name:"LessonTraining",props:{lesson:{type:Object,required:!0}},setup(o){const a=o;l(JSON.parse(localStorage.getItem("response-lesson")));const t=l(JSON.parse(localStorage.getItem("response-page"))),u=l(JSON.parse(localStorage.getItem("response-duration"))),r=l(!1),x="/"+a.lesson.file;function g(e){pdfjsLib.getDocument(x).promise.then(function(c){c.getPage(e).then(function(_){const d=_.getViewport({scale:1.5}),p=document.getElementById("pdf-canvas"),w=p.getContext("2d");p.height=d.height,p.width=d.width;const y={canvasContext:w,viewport:d};_.render(y)})}).catch(function(c){console.error("Error loading PDF: ",c)})}const m=new Date,i=P(m.setSeconds(m.getSeconds()+u.value));function v(e){u.value=e,localStorage.setItem("response-duration",JSON.stringify(u.value))}N(()=>{D(async()=>{v(Object.values(i.isRunning)[0].seconds),i.isExpired.value&&(r.value=!0)}),g(t.value)});const S=()=>{t.value=parseInt(t.value)+1,localStorage.setItem("response-page",t.value);const e=a.lesson.duration_per_slide;v(e),i.restart(new Date().setSeconds(new Date().getSeconds()+e)),g(t.value),r.value=!1},f=k({responseDataCourse:""}),I=()=>{f.responseDataCourse=a.lesson.course_id;try{setTimeout(()=>{f.post(route("trainings.endLesson")),localStorage.removeItem("response-page"),localStorage.removeItem("response-lesson")},1e3)}catch{}};return(e,c)=>(s(),n(L,null,[C(E(O),{title:"Lesson Trainings"}),h("div",V,[F,t.value==a.lesson.page_total?(s(),n("div",q,[r.value?(s(),n("button",{key:0,onClick:I,id:"next-button",class:"bg-blue-500 hover:bg-blue-600 text-2xl py-2 px-5 rounded-md font-bold absolute"},"END LESSON")):b("",!0)])):(s(),n("div",z,[r.value?(s(),n("button",{key:0,onClick:S,id:"next-button",class:"bg-blue-500 hover:bg-blue-600 text-2xl py-2 px-5 rounded-md font-bold absolute"},"Next")):b("",!0)]))])],64))}},K=j(M,[["__scopeId","data-v-8df1b777"]]);export{K as default};
